<!DOCTYPE html>
<html>
<head>
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¯ÙˆØ¯Ø©</title>
    <link rel="icon" type="image/png" href="iconD.png">
    <style>
        canvas {
            border: 2px solid black;
            display: block;
            margin: 0 auto;
        }
        #restartButton {
            display: block;
            margin: 20px auto;
            padding: 15px 30px;
            font-size: 24px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #restartButton:hover {
            background-color: #45a049;
            transform: scale(1.1);
        }
        #scoreBoard {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            font-weight: bold;
            direction: rtl;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #heartsDisplay {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        .heart {
            color: red;
            font-size: 24px;
        }
        #shopButton, #skinsButton {
            margin-top: 20px;
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 24px;
            font-weight: bold;
        }
        #shopButton:hover, #skinsButton:hover {
            background-color: #45a049;
        }
        #helpButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            width: 60px;
            height: 60px;
        }
        #helpButton:hover {
            background-color: #1976D2;
            transform: scale(1.1);
        }
        .helpIcon {
            width: 40px;
            height: 40px;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        #coinsBoard {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
            direction: rtl;
            display: flex;
            align-items: center;
        }
        .coinIcon {
            width: 50px;
            height: 50px;
            margin-left: 10px;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        .shopIcon {
            width: 80px;
            height: 80px;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        #codeSection {
            text-align: center;
            margin-top: 20px;
            direction: rtl;
        }
        #codeInput {
            padding: 10px;
            font-size: 18px;
            width: 200px;
            margin-left: 10px;
            border: 2px solid #4CAF50;
            border-radius: 5px;
        }
        #submitCode {
            padding: 10px 20px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #submitCode:hover {
            background-color: #45a049;
            transform: scale(1.05);
        }
        #spinWheel {
            position: absolute;
            top: 80px;
            left: 20px;
            background-color: #FF9800;
            color: white;
            padding: 10px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            width: 200px;
            text-align: center;
        }
        
        #spinWheel:hover {
            background-color: #F57C00;
            transform: scale(1.05);
        }
        
        .wheel-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .wheel-container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            direction: rtl;
        }
        
        #wheelResult {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background-color: #f5f5f5;
        }
        
        #wheelStats {
            position: absolute;
            top: 160px;
            left: 20px;
            color: black;
            font-size: 14px;
            direction: rtl;
            text-align: right;
            width: 200px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div id="coinsBoard">
        <span id="coins">0</span>
        <img src="coin.png" class="coinIcon" alt="Ø¹Ù…Ù„Ø©">
        <button id="spinWheel">ğŸ¡ Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¯ÙˆØ§Ø±Ø© (3 Ø¹Ù…Ù„Ø§Øª)</button>
        <div id="wheelStats">
            Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©:<br>
            Ù„Ø§ Ø´ÙŠØ¡: 30%<br>
            Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©: 25%<br>
            3 Ø¹Ù…Ù„Ø§Øª: 25%<br>
            17 Ø¹Ù…Ù„Ø©: 19%<br>
            Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†: 1%<br>
            <br>
            Ù…Ø¹ Ø§Ù„Ø­Ø¸ Ø§Ù„Ù…Ù„ÙƒÙŠ:<br>
            Ù„Ø§ Ø´ÙŠØ¡: 0%<br>
            Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©: 30%<br>
            3 Ø¹Ù…Ù„Ø§Øª: 30%<br>
            17 Ø¹Ù…Ù„Ø©: 30%<br>
            Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†: 10%
        </div>
    </div>
    <div id="scoreBoard">
        Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span>
        <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
            <button id="shopButton">
                <img src="shop.png" class="shopIcon" alt="Ø§Ù„Ù…ØªØ¬Ø±">
                Ø§Ù„Ù…ØªØ¬Ø±
            </button>
            <button id="skinsButton">
                <img src="store skin.png" class="shopIcon" alt="Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±">
                Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±
            </button>
            <button id="randomCodeButton" style="background-color: #ff9800; padding: 15px 30px; font-size: 20px;">
                ğŸ² ÙƒÙˆØ¯ Ø¹Ø´ÙˆØ§Ø¦ÙŠ (9 Ø¹Ù…Ù„Ø§Øª)
            </button>
        </div>
    </div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <button id="restartButton">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
    <div id="codeSection">
        <input type="text" id="codeInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø±ÙŠ">
        <button id="submitCode">ØªØ­Ù‚Ù‚</button>
    </div>
    <button id="helpButton">
        <img src="info.png" class="helpIcon" alt="Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©">
    </button>
    <audio id="popSound" src="pop1.mp3"></audio>
    <audio id="bigPopSound" src="bigpop.mp3"></audio>
    <audio id="impossibleSound" src="inpossible.mp3"></audio>
    <audio id="winSound" src="win.mp3"></audio>
    <audio id="gameOverSound" src="game over.mp3"></audio>
    <audio id="sorrySound" src="sorry mate.mp3"></audio>
    <audio id="coinWinSound" src="coinwin.mp3"></audio>
    <audio id="spinWinSound" src="spinwin.mp3"></audio>
    <audio id="uSpinWinSound" src="uspinwin.mp3"></audio>
    <div class="wheel-overlay" id="wheelOverlay">
        <div class="wheel-container">
            <h2>Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¯ÙˆØ§Ø±Ø©</h2>
            <div id="wheelResult"></div>
            <button onclick="closeWheel()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        document.getElementById('shopButton').addEventListener('click', function() {
            // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
            localStorage.setItem('snakeGameState', JSON.stringify({
                snake: snake,
                food: food,
                direction: d,
                score: score
            }));
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù…ØªØ¬Ø±
            window.location.href = 'shop.html';
        });

        document.getElementById('skinsButton').addEventListener('click', function() {
            // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
            localStorage.setItem('snakeGameState', JSON.stringify({
                snake: snake,
                food: food,
                direction: d,
                score: score
            }));
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±
            window.location.href = 'skin.html';
        });
        
        // Ø­Ø¬Ù… Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙˆØ§Ø­Ø¯
        const box = 20;
        
        // Ø§Ù„Ø¯ÙˆØ¯Ø©
        let snake = [];
        snake[0] = {
            x: 10 * box,
            y: 10 * box
        };
        
        // Ø§Ù„Ø·Ø¹Ø§Ù…
        let food = {
            x: Math.floor(Math.random() * 19 + 1) * box,
            y: Math.floor(Math.random() * 19 + 1) * box
        };
        
        // Ø§Ù„Ø§ØªØ¬Ø§Ù‡
        let d;
        let lastDirectionChange = 0;
        const DIRECTION_CHANGE_DELAY = 30; // ØªØ£Ø®ÙŠØ± 50 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ø¨ÙŠÙ† ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø§ØªØ¬Ø§Ù‡
        
        document.addEventListener("keydown", direction);
        
        function direction(event) {
            const currentTime = Date.now();
            if (currentTime - lastDirectionChange < DIRECTION_CHANGE_DELAY) return;
            
            if(event.keyCode == 37 && d != "RIGHT") {
                d = "LEFT";
                lastDirectionChange = currentTime;
            }
            else if(event.keyCode == 38 && d != "DOWN") {
                d = "UP";
                lastDirectionChange = currentTime;
            }
            else if(event.keyCode == 39 && d != "LEFT") {
                d = "RIGHT";
                lastDirectionChange = currentTime;
            }
            else if(event.keyCode == 40 && d != "UP") {
                d = "DOWN";
                lastDirectionChange = currentTime;
            }
        }
        
        function collision(head, array) {
            for(let i = 0; i < array.length; i++) {
                if(head.x == array[i].x && head.y == array[i].y) return true;
            }
            return false;
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·
        let score = 0;
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        let coins = localStorage.getItem('snakeGameCoins') || 0;
        coins = parseInt(coins);
        document.getElementById('coins').textContent = coins;
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø¯ÙˆØ¯
        let snakeColor = localStorage.getItem('snakeColor') || 'green';
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„Ù„ÙƒØ±Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
        let bigBallPurchased = localStorage.getItem('bigBallPurchased') === 'true';
        let isBigBall = false;

        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„ÙƒØ±Ø© Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©
        let miracleBallPurchased = localStorage.getItem('miracleBallPurchased') === 'true';
        let isMiracleBall = false;

        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„Ù„Ø­Ø¸ Ø§Ù„Ù…Ù„ÙƒÙŠ
        let royalLuckPurchased = localStorage.getItem('royalLuckPurchased') === 'true';

        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„Ù„Ø¬Ù„Ø¯ Ø§Ù„Ø°Ù‡Ø¨ÙŠ
        let goldenSkinPurchased = localStorage.getItem('goldenSkinPurchased') === 'true';
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„Ø¬Ù„Ø¯ Ø§Ù„Ø®Ø¨Ø±Ø©
        let experienceSkinPurchased = localStorage.getItem('experienceSkinPurchased') === 'true';
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ù„Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†
        let cursedSkinPurchased = localStorage.getItem('cursedSkinPurchased') === 'true';
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØµÙˆØª
        const popSound = document.getElementById('popSound');
        const bigPopSound = document.getElementById('bigPopSound');
        const impossibleSound = document.getElementById('impossibleSound');
        const winSound = document.getElementById('winSound');
        const gameOverSound = document.getElementById('gameOverSound');
        const sorrySound = document.getElementById('sorrySound');
        const coinWinSound = document.getElementById('coinWinSound');
        const spinWinSound = document.getElementById('spinWinSound');
        const uSpinWinSound = document.getElementById('uSpinWinSound');
        
        function resetGame() {
            snake = [];
            snake[0] = {
                x: 10 * box,
                y: 10 * box
            };
            
            food = {
                x: Math.floor(Math.random() * 19 + 1) * box,
                y: Math.floor(Math.random() * 19 + 1) * box
            };
            
            d = undefined;
            score = 0;
            document.getElementById('score').textContent = score;
            clearInterval(game);
            game = setInterval(draw, 100);
        }

        document.getElementById('restartButton').addEventListener('click', resetGame);
        
        function draw() {
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            for(let i = 0; i < snake.length; i++) {
                if (snakeColor === 'cursed') {
                    if (i === 0) {
                        ctx.fillStyle = '#BC8F8F';
                    } else {
                        continue; // ØªØ®Ø·ÙŠ Ø±Ø³Ù… Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¬Ø³Ù… Ù„Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†
                    }
                } else if (snakeColor === 'golden') {
                    if (i === 0) {
                        ctx.fillStyle = '#FFD700';
                    } else {
                        ctx.fillStyle = '#FFA500';
                    }
                } else if (snakeColor === 'speed') {
                    if (i === 0) {
                        ctx.fillStyle = '#00BFFF';
                    } else {
                        ctx.fillStyle = '#b9f2ff';
                    }
                } else if (snakeColor === 'experience') {
                    if (i === 0) {
                        ctx.fillStyle = '#696969';
                    } else {
                        ctx.fillStyle = '#C0C0C0';
                    }
                } else if (snakeColor === 'slow') {
                    // Ø±Ø³Ù… Ø§Ù„Ø±Ø£Ø³ Ø¨Ù„ÙˆÙ† #8B4513
                    ctx.fillStyle = '#8B4513';
                    ctx.fillRect(snake[i].x * box, snake[i].y * box, box - 2, box - 2);
                } else {
                    ctx.fillStyle = (i == 0) ? 
                        (snakeColor === 'green' ? 'green' : 
                         (snakeColor === 'blue' ? 'blue' : 
                          (snakeColor === 'orange' ? '#FF4500' : '#DAA520'))) : 
                        (snakeColor === 'green' ? 'lightgreen' : 
                         (snakeColor === 'blue' ? 'lightblue' : 
                          (snakeColor === 'orange' ? '#FFA500' : '#FFD700')));
                }
                ctx.fillRect(snake[i].x, snake[i].y, box, box);
                
                ctx.strokeStyle = "black";
                ctx.strokeRect(snake[i].x, snake[i].y, box, box);
            }
            
            // Ø±Ø³Ù… Ø§Ù„Ø·Ø¹Ø§Ù…
            if (isBigBall) {
                ctx.fillStyle = "purple";
                ctx.beginPath();
                ctx.arc(food.x + box/2, food.y + box/2, box/2, 0, Math.PI * 2);
                ctx.fill();
            } else if (isMiracleBall) {
                ctx.fillStyle = "black";
                ctx.beginPath();
                ctx.arc(food.x + box/2, food.y + box/2, box/2, 0, Math.PI * 2);
                ctx.fill();
            } else {
            ctx.fillStyle = "red";
            ctx.fillRect(food.x, food.y, box, box);
            }
            
            let snakeX = snake[0].x;
            let snakeY = snake[0].y;
            
            if(d == "LEFT") snakeX -= box;
            if(d == "UP") snakeY -= box;
            if(d == "RIGHT") snakeX += box;
            if(d == "DOWN") snakeY += box;
            
            if(snakeX == food.x && snakeY == food.y) {
                // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙƒØ±Ø©
                if (bigBallPurchased && isBigBall) {
                    bigPopSound.currentTime = 0;
                    bigPopSound.play();
                    score += 5;
                } else if (miracleBallPurchased && isMiracleBall) {
                    impossibleSound.currentTime = 0;
                    impossibleSound.play();
                    score += 25;
                } else {
                    popSound.currentTime = 0;
                    popSound.play();
                    if (snakeColor === 'golden') {
                        score += 2;
                    } else {
                score++;
                    }
                }
                document.getElementById('score').textContent = score;
                
                if(score >= 30) {
                    clearInterval(game);
                    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„ÙÙˆØ²
                    winSound.currentTime = 0;
                    winSound.play();
                    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ²
                    coins++;
                    localStorage.setItem('snakeGameCoins', coins);
                    document.getElementById('coins').textContent = coins;
                    alert("Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ ÙØ²Øª ÙˆØ­ØµÙ„Øª Ø¹Ù„Ù‰ Ø¹Ù…Ù„Ø© Ø°Ù‡Ø¨ÙŠØ©!");
                    return;
                }
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø·Ø¹Ø§Ù… Ø¬Ø¯ÙŠØ¯
                food = {
                    x: Math.floor(Math.random() * 19 + 1) * box,
                    y: Math.floor(Math.random() * 19 + 1) * box
                };

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø¸Ù‡ÙˆØ± Ø§Ù„ÙƒØ±Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙˆÙƒØ±Ø© Ø§Ù„Ù…Ø¹Ø¬Ø²Ø©
                if (bigBallPurchased) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ø¸ Ø§Ù„Ù…Ù„ÙƒÙŠ Ù…ÙØ¹Ù„ØŒ Ø²ÙŠØ§Ø¯Ø© Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¸ x10
                    isBigBall = Math.random() < (royalLuckPurchased ? 0.99 : 0.1); // 100% Ø£Ùˆ 10% ÙØ±ØµØ©
                } else {
                    isBigBall = false;
                }

                if (miracleBallPurchased) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ø¸ Ø§Ù„Ù…Ù„ÙƒÙŠ Ù…ÙØ¹Ù„ØŒ Ø²ÙŠØ§Ø¯Ø© Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¸ x10
                    isMiracleBall = Math.random() < (royalLuckPurchased ? 0.05 : 0.005); // 5% Ø£Ùˆ 0.5% ÙØ±ØµØ©
                } else {
                    isMiracleBall = false;
                }
            } else {
                snake.pop();
            }
            
            let newHead = {
                x: snakeX,
                y: snakeY
            };
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø¨Ø§Ù„Ø¬Ø¯Ø§Ø±
            if(snakeX < 0 || snakeX > canvas.width - box || snakeY < 0 || snakeY > canvas.height - box) {
                if(snakeColor === 'experience') {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¬Ù„Ø¯ Ø§Ù„Ø®Ø¨Ø±Ø© Ù…ÙØ¹Ù„ØŒ Ø§Ø¸Ù‡Ø± Ù…Ù† Ø§Ù„Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¢Ø®Ø±
                    if(snakeX < 0) snakeX = canvas.width - box;
                    if(snakeX > canvas.width - box) snakeX = 0;
                    if(snakeY < 0) snakeY = canvas.height - box;
                    if(snakeY > canvas.height - box) snakeY = 0;
                } else {
                    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø¬Ù„Ø¯ Ø§Ù„Ø®Ø¨Ø±Ø© Ù…ÙØ¹Ù„ØŒ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
                    clearInterval(game);
                    gameOverSound.currentTime = 0;
                    gameOverSound.play();
                    alert("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ù„Ù†Ù‚Ø§Ø·: " + score);
                    return;
                }
            }
            
            newHead.x = snakeX;
            newHead.y = snakeY;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø¨Ø§Ù„Ù†ÙØ³
            if(collision(newHead, snake)) {
                clearInterval(game);
                gameOverSound.currentTime = 0;
                gameOverSound.play();
                alert("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ù„Ù†Ù‚Ø§Ø·: " + score);
            }
            
            snake.unshift(newHead);
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø³Ø±Ø¹Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø®ØªØ§Ø±
        if (snakeColor === 'speed') {
            gameSpeed = 50; // Ø³Ø±Ø¹Ø© Ù…Ø¶Ø§Ø¹ÙØ© (Ø£Ø³Ø±Ø¹)
        } else if (snakeColor === 'slow') {
            gameSpeed = 200; // Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø·ÙŠØ¦Ø©
        } else {
            gameSpeed = 100; // Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
        }
        
        let game = setInterval(draw, gameSpeed);

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø³Ø±ÙŠØ©
        document.getElementById('submitCode').addEventListener('click', function() {
            const code = document.getElementById('codeInput').value.trim();
            // Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
            let usedCodes = JSON.parse(localStorage.getItem('usedCodes') || '[]');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù…Ù† Ù‚Ø¨Ù„
            if (usedCodes.includes(code)) {
                alert('Ø¹Ø°Ø±Ø§Ù‹! Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù…Ù† Ù‚Ø¨Ù„!');
                document.getElementById('codeInput').value = '';
                return;
            }
            
            if(code === 'doda') {
                coins += 50;
                localStorage.setItem('snakeGameCoins', coins);
                document.getElementById('coins').textContent = coins;
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ 50 Ù‚Ø·Ø¹Ø© Ø°Ù‡Ø¨ÙŠØ©!');
                document.getElementById('codeInput').value = '';
            } else if(code === 'Fin') {
                localStorage.setItem('luckyRandomCode', 'true');
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø­Ø¸ Ø£Ø¹Ù„Ù‰ ÙÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©!');
                document.getElementById('codeInput').value = '';
            } else if(code === 'anas 3amk') {
                coins += 500;
                localStorage.setItem('snakeGameCoins', coins);
                document.getElementById('coins').textContent = coins;
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ 500 Ù‚Ø·Ø¹Ø© Ø°Ù‡Ø¨ÙŠØ©!');
                document.getElementById('codeInput').value = '';
            } else if(code === 'UPDATE1') {
                localStorage.setItem('snakeColor', 'orange');
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ!');
                document.getElementById('codeInput').value = '';
            } else if(code === 'speed doda') {
                localStorage.setItem('snakeColor', 'speed');
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                alert('Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø¬Ù„Ø¯ Ø§Ù„Ø³Ø±Ø¹Ø©!');
                document.getElementById('codeInput').value = '';
            } else {
                alert('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­!');
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø²Ø± Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        document.getElementById('randomCodeButton').addEventListener('click', function() {
            if (coins >= 9) {
                coins -= 9;
                localStorage.setItem('snakeGameCoins', coins);
                document.getElementById('coins').textContent = coins;

                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„ÙŠÙ‡Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹
                const availableCodes = ['doda', 'UPDATE1', 'speed doda', 'Fin', ];
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙØ¹ÙŠÙ„ ÙƒÙˆØ¯ Ø§Ù„Ø­Ø¸
                const hasLuckyCode = localStorage.getItem('luckyRandomCode') === 'true';
                
                // Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† "Ù„Ø§ Ø´ÙŠØ¡" Ø£Ùˆ ÙƒÙˆØ¯ Ù…Ø¹ Ù†Ø³Ø¨ Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ ØªÙØ¹ÙŠÙ„ ÙƒÙˆØ¯ Ø§Ù„Ø­Ø¸
                if (Math.random() < (hasLuckyCode ? 0.3 : 0.5)) {
                    alert('Ù„Ù„Ø£Ø³Ù Ù„Ù… ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£ÙŠ Ø´ÙŠØ¡!');
                } else {
                    const randomCode = availableCodes[Math.floor(Math.random() * availableCodes.length)];
                    document.getElementById('codeInput').value = randomCode;
                    alert('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ! Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "ØªØ­Ù‚Ù‚" Ù„ØªÙØ¹ÙŠÙ„Ù‡.');
                }
            } else {
                alert('Ø¹Ø°Ø±Ø§Ù‹! Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø¹Ù…Ù„Ø§Øª ÙƒØ§ÙÙŠØ©!');
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø²Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        document.getElementById('helpButton').addEventListener('click', function() {
            window.location.href = 'help.html';
        });

        document.getElementById('spinWheel').addEventListener('click', function() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø´Ø±Ø§Ø¡ Ù…ÙŠØ²Ø© Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¯ÙˆØ§Ø±Ø©
            if(localStorage.getItem('wheelPurchased') !== 'true') {
                alert('ÙŠØ¬Ø¨ Ø´Ø±Ø§Ø¡ Ù…ÙŠØ²Ø© Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¯ÙˆØ§Ø±Ø© Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ø£ÙˆÙ„Ø§Ù‹!');
                return;
            }
            
            if (coins >= 3) {
                coins -= 3;
                localStorage.setItem('snakeGameCoins', coins);
                document.getElementById('coins').textContent = coins;
                
                const hasRoyalLuck = localStorage.getItem('royalLuckPurchased') === 'true';
                const random = Math.random() * 100;
                let result = '';
                
                if (hasRoyalLuck) {
                    // Ù†Ø³Ø¨ Ø§Ù„Ø­Ø¸ Ø§Ù„Ù…Ù„ÙƒÙŠ
                    if (random < 30) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 1;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©';
                    } else if (random < 60) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 3;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª 3 Ø¹Ù…Ù„Ø§Øª';
                    } else if (random < 90) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 17;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª 17 Ø¹Ù…Ù„Ø©';
                    } else {
                        uSpinWinSound.currentTime = 0;
                        uSpinWinSound.play();
                        localStorage.setItem('cursedSkinPurchased', 'true');
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†! ğŸ‘»';
                    }
                } else {
                    // Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
                    if (random < 30) {
                        sorrySound.currentTime = 0;
                        sorrySound.play();
                        result = 'Ù„Ø§ Ø´ÙŠØ¡! Ø­Ø¸Ø§Ù‹ Ø£ÙˆÙØ± ÙÙŠ Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©';
                    } else if (random < 55) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 1;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©';
                    } else if (random < 80) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 3;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª 3 Ø¹Ù…Ù„Ø§Øª';
                    } else if (random < 99) {
                        coinWinSound.currentTime = 0;
                        coinWinSound.play();
                        coins += 17;
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª 17 Ø¹Ù…Ù„Ø©';
                    } else {
                        uSpinWinSound.currentTime = 0;
                        uSpinWinSound.play();
                        localStorage.setItem('cursedSkinPurchased', 'true');
                        result = 'Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†! ğŸ‘»';
                    }
                }
                
                localStorage.setItem('snakeGameCoins', coins);
                document.getElementById('coins').textContent = coins;
                document.getElementById('wheelResult').textContent = result;
                document.getElementById('wheelOverlay').style.display = 'flex';
            } else {
                alert('Ø¹Ø°Ø±Ø§Ù‹! Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø¹Ù…Ù„Ø§Øª ÙƒØ§ÙÙŠØ©!');
            }
        });
        
        function closeWheel() {
            document.getElementById('wheelOverlay').style.display = 'none';
        }
    </script>
</body>
</html>
